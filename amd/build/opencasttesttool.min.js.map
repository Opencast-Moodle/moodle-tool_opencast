{"version":3,"sources":["../src/opencasttesttool.js"],"names":["define","$","Ajax","Str","ModalFactory","Notification","TestTool","activateButton","registerClickEvent","prototype","each","is","hasClass","removeAttr","removeClass","addClass","click","e","preventDefault","instanceid","target","data","suffix","apiurl","find","val","apiusername","apipassword","promise","call","methodname","args","titlePromise","get_string","modalPromise","create","type","types","CANCEL","when","then","connectionTestResponse","title","modal","setTitle","setBody","testresult","show","catch","exception"],"mappings":"AAsBAA,OAAM,kCAAC,CACC,QADD,CAEC,WAFD,CAGC,UAHD,CAIC,oBAJD,CAKC,mBALD,CAAD,CAMF,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAAuBC,CAAvB,CAAqCC,CAArC,CAAmD,CAK/C,GAAIC,CAAAA,CAAQ,CAAG,UAAW,CACtB,KAAKC,cAAL,GACA,KAAKC,kBAAL,EACH,CAHD,CAQAF,CAAQ,CAACG,SAAT,CAAmBF,cAAnB,CAAoC,UAAW,CAC3CN,CAAC,CAAC,iBAAD,CAAD,CAAqBS,IAArB,CAA0B,UAAW,CACjC,GAAIT,CAAC,CAAC,IAAD,CAAD,CAAQU,EAAR,CAAW,UAAX,GAA0BV,CAAC,CAAC,IAAD,CAAD,CAAQW,QAAR,CAAiB,UAAjB,CAA9B,CAA4D,CACxDX,CAAC,CAAC,IAAD,CAAD,CAAQY,UAAR,CAAmB,UAAnB,EACAZ,CAAC,CAAC,IAAD,CAAD,CAAQY,UAAR,CAAmB,OAAnB,EACAZ,CAAC,CAAC,IAAD,CAAD,CAAQa,WAAR,CAAoB,sBAApB,EACAb,CAAC,CAAC,IAAD,CAAD,CAAQc,QAAR,CAAiB,eAAjB,CACH,CACJ,CAPD,CAQH,CATD,CAaAT,CAAQ,CAACG,SAAT,CAAmBD,kBAAnB,CAAwC,UAAW,CAC/CP,CAAC,CAAC,iBAAD,CAAD,CAAqBe,KAArB,CAA2B,SAASC,CAAT,CAAY,CACnCA,CAAC,CAACC,cAAF,GADmC,GAE/BC,CAAAA,CAAU,CAAGlB,CAAC,CAACgB,CAAC,CAACG,MAAH,CAAD,CAAYC,IAAZ,CAAiB,YAAjB,CAFkB,CAG/BC,CAAM,CAAIH,CAAD,CAAe,IAAMA,CAArB,CAAkC,EAHZ,CAM/BI,CAAM,CAAGtB,CAAC,CAAC,gBAAkBqB,CAAnB,CAAD,CAA4BE,IAA5B,CAAiC,OAAjC,EAA0CC,GAA1C,EANsB,CAO/BC,CAAW,CAAGzB,CAAC,CAAC,qBAAuBqB,CAAxB,CAAD,CAAiCE,IAAjC,CAAsC,OAAtC,EAA+CC,GAA/C,EAPiB,CAQ/BE,CAAW,CAAG1B,CAAC,CAAC,qBAAuBqB,CAAxB,CAAD,CAAiCE,IAAjC,CAAsC,OAAtC,EAA+CC,GAA/C,EARiB,CAkB/BG,CAAO,CAAG1B,CAAI,CAAC2B,IAAL,CADA,CAAC,CAACC,UAAU,CAAE,oCAAb,CAAmDC,IAAI,CAP3D,CACP,OAAUR,CADH,CAEP,YAAeG,CAFR,CAGP,YAAeC,CAHR,CAOI,CAAD,CACA,CAlBqB,CAoB/BK,CAAY,CAAG7B,CAAG,CAAC8B,UAAJ,CAAe,aAAf,CAA8B,eAA9B,CApBgB,CAqB/BC,CAAY,CAAG9B,CAAY,CAAC+B,MAAb,CAAoB,CAACC,IAAI,CAAEhC,CAAY,CAACiC,KAAb,CAAmBC,MAA1B,CAApB,CArBgB,CAsBnCrC,CAAC,CAACsC,IAAF,CAAOX,CAAO,CAAC,CAAD,CAAd,CAAmBI,CAAnB,CAAiCE,CAAjC,EAA+CM,IAA/C,CAAoD,SAASC,CAAT,CAAiCC,CAAjC,CAAwCC,CAAxC,CAA+C,CAC/FA,CAAK,CAACC,QAAN,CAAeF,CAAf,EACAC,CAAK,CAACE,OAAN,CAAcJ,CAAsB,CAACK,UAArC,EAEAH,CAAK,CAACI,IAAN,GACA,MAAOJ,CAAAA,CACV,CAND,EAMGK,KANH,CAMS3C,CAAY,CAAC4C,SANtB,CAOH,CA7BD,CA8BH,CA/BD,CAiCA,MAAoD,CAQhD,KAAQ,eAAW,CACf,MAAO,IAAI3C,CAAAA,CACd,CAV+C,CAYvD,CA7EC,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * AMD module for opencast connection test tool\n *\n * @module     tool_opencast/opencasttesttool\n * @copyright  2021 Farbod Zamani (zamani@elan-ev.de)\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine([\n        'jquery',\n        'core/ajax',\n        'core/str',\n        'core/modal_factory',\n        'core/notification'],\n    function($, Ajax, Str, ModalFactory, Notification) {\n\n        /**\n         * TestTool class.\n         */\n        var TestTool = function() {\n            this.activateButton();\n            this.registerClickEvent();\n        };\n\n        /**\n         * Register button activation.\n         */\n        TestTool.prototype.activateButton = function() {\n            $('.testtool-modal').each(function() {\n                if ($(this).is(':visible') && $(this).hasClass('disabled')) {\n                    $(this).removeAttr('disabled');\n                    $(this).removeAttr('title');\n                    $(this).removeClass('disabled btn-warning');\n                    $(this).addClass('btn-secondary');\n                }\n            });\n        };\n        /**\n         * Register event listener.\n         */\n        TestTool.prototype.registerClickEvent = function() {\n            $('.testtool-modal').click(function(e) {\n                e.preventDefault();\n                var instanceid = $(e.target).data('instanceid');\n                var suffix = (instanceid) ? '_' + instanceid : '';\n\n\n                var apiurl = $('#admin-apiurl' + suffix).find('input').val();\n                var apiusername = $('#admin-apiusername' + suffix).find('input').val();\n                var apipassword = $('#admin-apipassword' + suffix).find('input').val();\n\n                var args = {\n                    'apiurl': apiurl,\n                    'apiusername': apiusername,\n                    'apipassword': apipassword\n                };\n\n                // Get options.\n                var request = [{methodname: 'tool_opencast_connection_test_tool', args: args}];\n                var promise = Ajax.call(request);\n\n                var titlePromise = Str.get_string('testtoolurl', 'tool_opencast');\n                var modalPromise = ModalFactory.create({type: ModalFactory.types.CANCEL});\n                $.when(promise[0], titlePromise, modalPromise).then(function(connectionTestResponse, title, modal) {\n                    modal.setTitle(title);\n                    modal.setBody(connectionTestResponse.testresult);\n\n                    modal.show();\n                    return modal;\n                }).catch(Notification.exception);\n            });\n        };\n\n        return /** @alias tool_opencast/opencasttesttool */ {\n\n            /**\n             * Initialise the module.\n             *\n             * @method init\n             * @return {TestTool}\n             */\n            'init': function() {\n                return new TestTool();\n            }\n        };\n    });\n"],"file":"opencasttesttool.min.js"}