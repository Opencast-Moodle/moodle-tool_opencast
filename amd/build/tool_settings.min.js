define("tool_opencast/tool_settings",["exports","tool_opencast/tabulator","jquery","core/modal_factory","core/modal_events","core/str","core/notification"],(function(_exports,_tabulator,_jquery,_modal_factory,_modal_events,str,_notification){function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Javascript to initialise the opencast tool settings.
   *
   * @module     tool_opencast/tool_settings
   * @copyright  2021 Tamara Gunkel, University of MÃ¼nster
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_tabulator=_interopRequireDefault(_tabulator),_jquery=_interopRequireDefault(_jquery),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events),str=function(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}(str),_notification=_interopRequireDefault(_notification);_exports.init=instancesinputid=>{str.get_strings([{key:"name",component:"tool_opencast"},{key:"isvisible",component:"tool_opencast"},{key:"addinstance",component:"tool_opencast"},{key:"delete_instance",component:"tool_opencast"},{key:"delete_instance_confirm",component:"tool_opencast"},{key:"delete",component:"moodle"},{key:"isdefault",component:"tool_opencast"}]).then((function(jsstrings){var instancesinput=(0,_jquery.default)("#"+instancesinputid);if(instancesinput.length){instancesinput.parent().hide(),instancesinput.parent().next().hide();var instancestable=new _tabulator.default("#instancestable",{data:JSON.parse(instancesinput.val()),layout:"fitColumns",dataChanged:function(data){instancesinput.val(JSON.stringify(data))},columns:[{title:"ID",field:"id",widthGrow:0},{title:jsstrings[0],field:"name",editor:"input",widthGrow:2},{title:jsstrings[1],field:"isvisible",hozAlign:"center",widthGrow:0,formatter:function(cell){var input=document.createElement("input");return input.type="checkbox",input.checked=cell.getValue(),input.addEventListener("click",(function(){cell.getRow().update({isvisible:(0,_jquery.default)(this).prop("checked")?1:0})})),input}},{title:jsstrings[6],field:"isdefault",hozAlign:"center",widthGrow:0,formatter:function(cell){var input=document.createElement("input");return input.type="checkbox",input.checked=cell.getValue(),input.addEventListener("click",(function(){cell.getRow().update({isdefault:(0,_jquery.default)(this).prop("checked")?1:0})})),input}},{title:"",width:40,headerSort:!1,hozAlign:"center",formatter:function(){return'<i class="icon fa fa-trash fa-fw"></i>'},cellClick:function(e,cell){_modal_factory.default.create({type:_modal_factory.default.types.SAVE_CANCEL,title:jsstrings[3],body:jsstrings[4]}).then((function(modal){modal.setSaveButtonText(jsstrings[5]),modal.getRoot().on(_modal_events.default.save,(function(){cell.getRow().delete()})),modal.show()})).catch(_notification.default.exception)}}]});(0,_jquery.default)("#addrow-instancestable").click((function(){var ids=JSON.parse(instancesinput.val()).map((x=>x.id));ids.sort();var i,nextid=0;if(ids.includes(1))for(i=0;i<ids.length;i++){let nextElem=i+1;if(nextElem===ids.length)nextid=ids[i]+1;else if(ids[nextElem]!==ids[i]+1){nextid=ids[i]+1;break}}else nextid=1;instancestable.addRow({id:nextid,isvisible:!1,isdefault:!1})}))}})).catch(_notification.default.exception)}}));

//# sourceMappingURL=tool_settings.min.js.map