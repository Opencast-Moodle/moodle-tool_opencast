/**
 * AMD module for opencast connection test tool
 *
 * @module     tool_opencast/opencasttesttool
 * @copyright  2021 Farbod Zamani (zamani@elan-ev.de)
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("tool_opencast/opencasttesttool",["jquery","core/ajax","core/str","core/modal_factory","core/notification"],(function($,Ajax,Str,ModalFactory,Notification){var TestTool=function(){this.activateButton(),this.registerClickEvent()};return TestTool.prototype.activateButton=function(){$(".testtool-modal").each((function(){$(this).is(":visible")&&$(this).hasClass("disabled")&&($(this).removeAttr("disabled"),$(this).removeAttr("title"),$(this).removeClass("disabled btn-warning"),$(this).addClass("btn-secondary"))}))},TestTool.prototype.registerClickEvent=function(){$(".testtool-modal").click((function(e){e.preventDefault();var instanceid=$(e.target).data("instanceid"),suffix=instanceid?"_"+instanceid:"",request=[{methodname:"tool_opencast_connection_test_tool",args:{apiurl:$("#admin-apiurl"+suffix).find("input").val(),apiusername:$("#admin-apiusername"+suffix).find("input").val(),apipassword:$("#admin-apipassword"+suffix).find("input").val()}}],promise=Ajax.call(request),titlePromise=Str.get_string("testtoolurl","tool_opencast"),modalPromise=ModalFactory.create({type:ModalFactory.types.CANCEL});$.when(promise[0],titlePromise,modalPromise).then((function(connectionTestResponse,title,modal){return modal.setTitle(title),modal.setBody(connectionTestResponse.testresult),modal.show(),modal})).catch(Notification.exception)}))},{init:function(){return new TestTool}}}));

//# sourceMappingURL=opencasttesttool.min.js.map